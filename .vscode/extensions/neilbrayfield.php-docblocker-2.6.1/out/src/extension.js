var q=Object.create;var w=Object.defineProperty;var G=Object.getOwnPropertyDescriptor;var O=Object.getOwnPropertyNames,j=Object.getOwnPropertySymbols,Z=Object.getPrototypeOf,U=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var z=(r,e,t)=>e in r?w(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,B=(r,e)=>{for(var t in e||(e={}))U.call(e,t)&&z(r,t,e[t]);if(j)for(var t of j(e))V.call(e,t)&&z(r,t,e[t]);return r};var M=r=>w(r,"__esModule",{value:!0});var Q=(r,e)=>{M(r);for(var t in e)w(r,t,{get:e[t],enumerable:!0})},K=(r,e,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of O(e))!U.call(r,n)&&n!=="default"&&w(r,n,{get:()=>e[n],enumerable:!(t=G(e,n))||t.enumerable});return r},k=r=>K(M(w(r!=null?q(Z(r)):{},"default",r&&r.__esModule&&"default"in r?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r);Q(exports,{activate:()=>Y,deactivate:()=>J});var d=k(require("vscode"));var y=k(require("vscode"));var x=k(require("vscode")),C=class{constructor(e,t){this.signatureEnd=/[\{;]/;this.position=e,this.editor=t,this.setSignature(this.getBlock(e,this.signatureEnd))}test(){return this.pattern.test(this.signature)}match(){return this.signature.match(this.pattern)}setSignature(e){this.signature=e}getBlock(e,t){let n=e.line+1,a=this.editor.document.lineAt(n).text,i=a.search(/[^\s]/);if(i===-1)return"";let l=new x.Position(e.line+1,i);for(;!t.test(a);)n++,a=this.editor.document.lineAt(n).text;let c=new x.Position(n,a.search(t)),p=new x.Range(l,c);return this.editor.document.getText(p)}getEnclosed(e,t,n){let a=0,i=e.split(""),l=0;for(let c=0;c<i.length;c++){let p=i[c];if(p==n&&a==0){l=c;break}else p==n?a--:p==t&&a++;l=c}return e.substr(0,l)}getSplitWithoutEnclosed(e,t=","){let n=new Array,a=e.split(""),i=["{","(","["],l=["}",")","]"],c=0,p=0,o=0;for(let $=0;$<a.length;$++){let T=a[$];if(T===t&&$===a.length-1)break;if(T===t&&c===0){o=$,n.push(e.substr(p,o-p)),p=$+1;continue}else i.indexOf(T)>=0?c++:l.indexOf(T)>=0&&c--;o=$}return e.substr(p,o-p+1).match(/^\s*$/)||n.push(e.substr(p,o-p+1)),n}getClassHead(){if(this.classHead===void 0){let e=this.editor.document.lineCount<300?this.editor.document.lineCount-1:300,t=this.editor.document.getText(new x.Range(new x.Position(0,0),new x.Position(e,0))),a=/\s*(abstract|final)?\s*(class|trait|interface)/gm.exec(t);if(a===null)this.classHead=null;else{let i=this.editor.document.positionAt(a.index),l=new x.Range(new x.Position(0,0),i);this.classHead=this.editor.document.getText(l)}}return this.classHead}};var W=k(require("vscode"));var F=k(require("vscode")),s=class{constructor(){this.isLive=!0}static get instance(){return this._instance==null&&(this._instance=new this),this._instance}set live(e){this.isLive=e}setFallback(e){this.data=e}override(e){this.data=B(B({},this.data),e)}get(e){return this.isLive?e==="autoClosingBrackets"?F.workspace.getConfiguration("editor").get(e):F.workspace.getConfiguration("php-docblocker").get(e):this.data[e]}};var v=class{constructor(e=""){this.params=[];this.indentCharacter=" ";this.message=e}fromObject(e){e.return!==void 0&&(this.return=e.return),e.var!==void 0&&(this.var=e.var),e.message!==void 0&&(this.message=e.message),e.params!==void 0&&Array.isArray(e.params)&&e.params.forEach(t=>{this.params.push(new S(t.type,t.name))})}build(e=!1){let t=s.instance.get("extra"),n=s.instance.get("gap"),a=s.instance.get("returnGap"),l=s.instance.get("alignParams")?s.instance.get("alignReturn"):!1,c="",p="",o="",g="",$="";e&&(n=!0,t=[]),$="${###"+(this.message!=""?":":"")+this.message+"}";let T=this.getMaxParamLength(this.params,this.return);if(this.params.length&&(o="",this.params.forEach(m=>{o!=""&&(o+=`
`);let h=m.type,f=m.name.replace("$","\\$"),L=this.getParamAlignmentSpaces(T,f,h);o+="@param "+(l?this.indentCharacter:"")+"${###:"+h+"} "+L.prepend+f+L.append;let I=s.instance.get("paramDescription");I===!0?o+="${###}":typeof I=="string"&&(o+="${###:"+I+"}")})),this.var){p="@var ${###:"+this.var+"}";let m=s.instance.get("varDescription");m===!0?p+=" ${###}":typeof m=="string"&&(p+=" ${###:"+m+"}")}if(this.return&&(this.return!="void"||s.instance.get("returnVoid"))){let m=this.getReturnAlignmentSpaces(T);c="@return ${###:"+this.return+"}"+m.append;let h=s.instance.get("returnDescription");h===!0?c+="${###}":typeof h=="string"&&(c+="${###:"+h+"}")}Array.isArray(t)&&t.length>0&&(g=t.join(`
`));let P=[];for(let m in this.template){let h=this.template[m],f;m=="message"&&$?(f=$,n&&(h.gapAfter=!0)):m=="var"&&p?f=p:m=="return"&&c?(f=c,a&&(h.gapBefore=!0)):m=="param"&&o?f=o:m=="extra"&&g?f=g:h.content!==void 0&&(f=h.content),f&&h.gapBefore&&P[P.length-1]!=""&&P.push(""),f&&P.push(f),f&&h.gapAfter&&P.push("")}P[P.length-1]==""&&P.pop();let b=P.join(`
`),H=0;return b=b.replace(/###/gm,function(){return H++,H+""}),b=b.replace(/^$/gm," *"),b=b.replace(/^(?!(\s\*|\/\*))/gm," * $1"),s.instance.get("autoClosingBrackets")=="never"?b=`
`+b+`
 */`:b=`/**
`+b+`
 */`,new W.SnippetString(b)}set template(e){this._template=e}get template(){return this._template==null?{message:{},var:{},param:{},return:{},extra:{}}:this._template}getMaxParamLength(e,t){let n=s.instance.get("alignParams"),a=n?s.instance.get("alignReturn"):!1,i=0,l=0;return e.length&&n&&e.forEach(c=>{let p=c.type;p.length>i&&(i=p.length);let o=c.name.replace("$","\\$");o.length>l&&(l=o.length)}),t&&(t!="void"||s.instance.get("returnVoid"))&&a&&t.length>i&&(i=t.length),{type:i,name:l}}getParamAlignmentSpaces(e,t,n){let a=s.instance.get("alignParams"),i=s.instance.get("paramDescription"),l="",c="";return a&&(l=Array(e.type-n.length).fill(this.indentCharacter).join(""),c=Array(1+e.name-t.length).fill(this.indentCharacter).join("")),{append:i?a?c:this.indentCharacter:"",prepend:l}}getReturnAlignmentSpaces(e){let n=s.instance.get("alignParams")?s.instance.get("alignReturn"):!1,a=s.instance.get("returnDescription"),i="";return n&&(i=Array(1+e.type-this.return.length).fill(this.indentCharacter).join("")+Array(e.name).fill(this.indentCharacter).join("")),{append:a?n?i:this.indentCharacter:"",prepend:""}}},S=class{constructor(e,t){this.type=e,this.name=t}};var u=class{static get instance(){return this._instance||(this._instance=new this)}getResolvedTypeHints(e,t=null){let n=e.split("|");for(let a=0;a<n.length;a++)n[a]=this.getFullyQualifiedType(n[a],t),n[a]=this.getFormattedTypeByName(n[a]);return n.join("|")}getFullyQualifiedType(e,t){if(!s.instance.get("qualifyClassNames"))return e;let a=new RegExp("use\\s+([^ ]*?)((?:\\s+as\\s+))?("+e+");","gm").exec(t);return a!=null&&a[3]==e?(a[1].charAt(0)!="\\"&&(a[1]="\\"+a[1]),a[2]!=null?a[1]:a[1]+e):e}getFormattedTypeByName(e){switch(e){case"bool":case"boolean":return s.instance.get("useShortNames")?"bool":"boolean";case"int":case"integer":return s.instance.get("useShortNames")?"int":"integer";default:return e}}getTypeFromValue(e){let t;return e.match(/^\s*(false|true)\s*$/i)!==null||e.match(/^\s*\!/i)!==null?this.getFormattedTypeByName("bool"):e.match(/^\s*([\d-]+)\s*$/)!==null?this.getFormattedTypeByName("int"):e.match(/^\s*([\d.-]+)\s*$/)!==null?"float":e.match(/^\s*(["'])/)!==null||e.match(/^\s*<<</)!==null?"string":e.match(/^\s*(array\(|\[)/)!==null?"array":"[type]"}};var N=class extends C{constructor(){super(...arguments);this.pattern=/^\s*((.*)(protected|private|public))?(.*)?\s*function\s+&?([a-z0-9_]+)\s*\(([^{;]*)/im}parse(){let e=this.match(),t=new v("Undocumented function");t.template=s.instance.get("functionTemplate");let n=this.getEnclosed(e[6],"(",")"),a;if(n!=""){let c=this.getSplitWithoutEnclosed(n);s.instance.get("qualifyClassNames")&&(a=this.getClassHead());for(let p=0;p<c.length;p++){let g=c[p].match(/^\s*(?:(?:public|protected|private)\s+)?(\?)?\s*([A-Za-z0-9|_\\]+)?\s*\&?((?:[.]{3})?\$[A-Za-z0-9_]+)\s*\=?\s*(.*)\s*/im);var i="[type]";g[2]!=null&&(i=u.instance.getResolvedTypeHints(g[2],a)),g[2]!=null&&g[1]==="?"||g[2]!=null&&g[4]!=null&&g[2]!="mixed"&&g[4]=="null"?i+="|null":g[4]!=null&&g[4]!=""&&g[2]!="mixed"&&(i=u.instance.getFormattedTypeByName(u.instance.getTypeFromValue(g[4]))),t.params.push(new S(i,g[3]))}}let l=this.signature.match(/.*\)\s*\:\s*(\?)?\s*([a-zA-Z_|0-9\\]+)\s*$/m);return l!=null?(l[2]=u.instance.getResolvedTypeHints(l[2],this.getClassHead()),t.return=l[1]==="?"?u.instance.getFormattedTypeByName(l[2])+"|null":u.instance.getFormattedTypeByName(l[2])):t.return=this.getReturnFromName(e[5]),t}getReturnFromName(e){if(/^(is|has|can|should)(?:[A-Z0-9_]|$)/.test(e))return u.instance.getFormattedTypeByName("bool");switch(e){case"__construct":case"__destruct":case"__set":case"__unset":case"__wakeup":return null;case"__isset":return u.instance.getFormattedTypeByName("bool");case"__sleep":case"__debugInfo":return"array";case"__toString":return"string"}return"void"}};var _=class extends C{constructor(){super(...arguments);this.pattern=/^\s*(static)?\s*(protected|private|public)\s+(static)?\s*(\??\\?[a-zA-Z_\x7f-\xff][a-zA-Z0-9|_\x7f-\xff\\]+)?\s*(\$[A-Za-z0-9_]+)\s*\=?\s*([^;]*)/m}parse(){let e=this.match(),t=new v("Undocumented variable");if(t.template=s.instance.get("propertyTemplate"),e[4]){let n=e[4].match(/(\?)?(.*)/m),a;s.instance.get("qualifyClassNames")&&(a=this.getClassHead());let i=u.instance.getResolvedTypeHints(n[2],a);i=u.instance.getFormattedTypeByName(i),n[1]==="?"&&(i+="|null"),t.var=i}else e[6]?t.var=u.instance.getTypeFromValue(e[6]):t.var="[type]";return t}};var R=class extends C{constructor(){super(...arguments);this.pattern=/^\s*(abstract|final)?\s*(class|trait|interface)\s+([a-z0-9_]+)\s*/i}parse(){let e=this.match(),t=new v("Undocumented "+e[2]);return t.template=s.instance.get("classTemplate"),t}};var A=class{constructor(e,t){this.targetPosition=e.start,this.editor=t}autoDocument(){let e=new N(this.targetPosition,this.editor);if(e.test())return e.parse().build();let t=new _(this.targetPosition,this.editor);if(t.test())return t.parse().build();let n=new R(this.targetPosition,this.editor);return n.test()?n.parse().build():new v().build(!0)}};var D=class{constructor(){this.tagList=[{tag:"@api",snippet:"@api"},{tag:"@abstract",snippet:"@abstract"},{tag:"@after",snippet:"@after"},{tag:"@afterClass",snippet:"@afterClass"},{tag:"@author",snippet:"@author ${1:{{name}}} <${2:{{email}}}>"},{tag:"@backupGlobals",snippet:"@backupGlobals ${1:switch}"},{tag:"@backupStaticAttributes",snippet:"@backupStaticAttributes ${1:switch}"},{tag:"@before",snippet:"@before"},{tag:"@beforeClass",snippet:"@beforeClass"},{tag:"@category",snippet:"@category ${1:description}"},{tag:"@codeCoverageIgnore",snippet:"@codeCoverageIgnore"},{tag:"@codeCoverageIgnoreEnd",snippet:"@codeCoverageIgnoreEnd"},{tag:"@codeCoverageIgnoreStart",snippet:"@codeCoverageIgnoreStart"},{tag:"@copyright",snippet:"@copyright ${1:"+new Date().getFullYear()+"} ${2:Name}"},{tag:"@covers",snippet:"@covers ${1:fqcn}"},{tag:"@coversDefaultClass",snippet:"@coversDefaultClass ${1:fqcn}"},{tag:"@coversNothing",snippet:"@coversNothing"},{tag:"@dataProvider",snippet:"@dataProvider ${1:methodName}"},{tag:"@depends",snippet:"@depends ${1:methodName}"},{tag:"@deprecated",snippet:"@deprecated ${1:version}"},{tag:"@doesNotPerformAssertions",snippet:"@doesNotPerformAssertions"},{tag:"@example",snippet:"@example ${1:location} ${2:description}"},{tag:"@filesource",snippet:"@filesource"},{tag:"@final",snippet:"@final"},{tag:"@group",snippet:"@group ${1:group}"},{tag:"@global",snippet:"@global"},{tag:"@ignore",snippet:"@ignore ${1:description}"},{tag:"@inheritDoc",snippet:"@inheritDoc"},{tag:"@internal",snippet:"@internal ${1:description}"},{tag:"@large",snippet:"@large"},{tag:"@license",snippet:"@license ${1:MIT}"},{tag:"@link",snippet:"@link ${1:http://url.com}"},{tag:"@medium",snippet:"@medium"},{tag:"@method",snippet:"@method ${1:mixed} ${2:methodName()}"},{tag:"@mixin",snippet:"@mixin ${1:\\MyClass}"},{tag:"@package",snippet:"@package ${1:category}"},{tag:"@param",snippet:"@param ${1:mixed} $${2:name}"},{tag:"@preserveGlobalState",snippet:"@preserveGlobalState ${1:switch}"},{tag:"@property",snippet:"@property ${1:mixed} $${2:name}"},{tag:"@property-read",snippet:"@property-read ${1:mixed} $${2:name}"},{tag:"@property-write",snippet:"@property-write ${1:mixed} $${2:name}"},{tag:"@requires",snippet:"@requires ${1:mixed}"},{tag:"@return",snippet:"@return ${1:mixed}"},{tag:"@runInSeparateProcess",snippet:"@runInSeparateProcess"},{tag:"@runTestsInSeparateProcesses",snippet:"@runTestsInSeparateProcesses"},{tag:"@see",snippet:"@see ${1:http://url.com}"},{tag:"@since",snippet:"@since ${1:1.0.0}"},{tag:"@small",snippet:"@small"},{tag:"@source",snippet:"@source ${1:location} ${2:description}"},{tag:"@static",snippet:"@static"},{tag:"@subpackage",snippet:"@subpackage ${1:category}"},{tag:"@test",snippet:"@test"},{tag:"@testdox",snippet:"@testdox ${1:description}"},{tag:"@testWith",snippet:"@testWith ${1:elements}"},{tag:"@throws",snippet:"@throws ${1:Exception}"},{tag:"@ticket",snippet:"@ticket ${1:ticket}"},{tag:"@todo",snippet:"@todo ${1:Something}"},{tag:"@uses",snippet:"@uses ${1:MyClass::function} ${2:Name}"},{tag:"@var",snippet:"@var ${1:mixed}"},{tag:"@version",snippet:"@version ${1:1.0.0}"},{tag:"@psalm-var (Psalm)",snippet:"@psalm-var ${1:mixed}"},{tag:"@psalm-param (Psalm)",snippet:"@psalm-param ${1:mixed} $${2:name}"},{tag:"@psalm-return (Psalm)",snippet:"@psalm-return ${1:mixed}"},{tag:"@psalm-suppress (Psalm)",snippet:"@psalm-suppress ${1:IssueName}"},{tag:"@psalm-assert (Psalm)",snippet:"@psalm-assert ${1:[assertion]} $${2:var}"},{tag:"@psalm-assert-if-true (Psalm)",snippet:"@psalm-assert-if-true ${1:[assertion]} $${2:var}"},{tag:"@psalm-assert-if-false (Psalm)",snippet:"@psalm-assert-if-false ${1:[assertion]} $${2:var}"},{tag:"@psalm-ignore-nullable-return (Psalm)",snippet:"@psalm-ignore-nullable-return"},{tag:"@psalm-ignore-falsable-return (Psalm)",snippet:"@psalm-ignore-falsable-return"},{tag:"@psalm-seal-properties (Psalm)",snippet:"@psalm-seal-properties"},{tag:"@psalm-internal (Psalm)",snippet:"@psalm-internal ${1:Namespace}"},{tag:"@psalm-readonly (Psalm)",snippet:"@psalm-readonly"},{tag:"@psalm-mutation-free (Psalm)",snippet:"@psalm-mutation-free"},{tag:"@psalm-external-mutation-free (Psalm)",snippet:"@psalm-external-mutation-free"},{tag:"@psalm-immutable (Psalm)",snippet:"@psalm-immutable"},{tag:"@psalm-pure (Psalm)",snippet:"@psalm-pure"},{tag:"@phan-suppress (Phan)",snippet:"@phan-suppress ${1:IssueName}"},{tag:"@suppress (Phan)",snippet:"@suppress ${1:IssueName}"},{tag:"@phan-suppress-current-line (Phan)",snippet:"@phan-suppress-current-line ${1:IssueName, IssueName}"},{tag:"@phan-suppress-next-line (Phan)",snippet:"@phan-suppress-next-line ${1:IssueName, IssueName}"},{tag:"@phan-file-suppress (Phan)",snippet:"@phan-file-suppress ${1:IssueName}"},{tag:"@override (Phan)",snippet:"@override"},{tag:"@inherits (Phan)",snippet:"@inherits"},{tag:"@phan-assert (Phan)",snippet:"@phan-assert ${1:[assertion]} $${2:var}"},{tag:"@phan-assert-true-condition (Phan)",snippet:"@phan-assert-true-condition ${1:[assertion]} $${2:var}"},{tag:"@phan-assert-false-condition (Phan)",snippet:"@phan-assert-false-condition ${1:[assertion]} $${2:var}"},{tag:"@phan-closure-scope (Phan)",snippet:"@phan-closure-scope"},{tag:"@phan-read-only (Phan)",snippet:"@phan-read-only"},{tag:"@phan-write-only (Phan)",snippet:"@phan-write-only"},{tag:"@phan-pure (Phan)",snippet:"@phan-pure"},{tag:"@phan-phan-output-reference (Phan)",snippet:"@param ${1:mixed} $${2:name} @phan-phan-output-reference"},{tag:"@phan-phan-ignore-reference (Phan)",snippet:"@param ${1:mixed} $${2:name} @phan-phan-ignore-reference"},{tag:"@phan-var (Phan)",snippet:"@phan-var ${1:mixed}"},{tag:"@phan-param (Phan)",snippet:"@phan-param ${1:mixed} $${2:name}"},{tag:"@phan-return (Phan)",snippet:"@phan-return ${1:mixed}"},{tag:"@phan-return (Phan)",snippet:"@phan-return ${1:mixed}"},{tag:"@phan-method (Phan)",snippet:"@phan-method ${1:mixed} ${2:methodName()}"},{tag:"@template (Phan)",snippet:"@template"}]}get list(){return this.tagList}};var E=class{constructor(){this.tags=new D}provideCompletionItems(e,t,n){let a=[],i;if((i=e.getWordRangeAtPosition(t,/\/\*\*/))!==void 0){let p=new A(i,y.window.activeTextEditor),o=new y.CompletionItem("/**",y.CompletionItemKind.Snippet);o.detail="PHP DocBlocker",o.documentation="Generate a PHP DocBlock from the code snippet below.";let g=e.getWordRangeAtPosition(t,/\/\*\* \*\//);return o.range=g,o.insertText=p.autoDocument(),a.push(o),a}if((i=e.getWordRangeAtPosition(t,/\@[a-z]*/))===void 0)return a;let l=e.getText(i);return this.getTags().filter(p=>p.tag.match(l)!==null).forEach(p=>{let o=new y.CompletionItem(p.tag,y.CompletionItemKind.Snippet);o.range=i,o.insertText=new y.SnippetString(p.snippet),a.push(o)}),a}getTags(){let e=this.tags.list;return e.forEach((t,n)=>{t.tag=="@author"&&(t.snippet=t.snippet.replace("{{name}}",s.instance.get("author").name),t.snippet=t.snippet.replace("{{email}}",s.instance.get("author").email),e[n]=t)}),e}};function Y(r){["php","hack"].forEach(e=>{e=="hack"&&d.languages.setLanguageConfiguration(e,{wordPattern:/(-?\d*\.\d\w*)|([^\-\`\~\!\@\#\%\^\&\*\(\)\=\+\[\{\]\}\\\|\;\:\'\"\,\.\<\>\/\?\s]+)/g,onEnterRules:[{beforeText:/^\s*\/\*\*(?!\/)([^\*]|\*(?!\/))*$/,afterText:/^\s*\*\/$/,action:{indentAction:d.IndentAction.IndentOutdent,appendText:" * "}},{beforeText:/^\s*\/\*\*(?!\/)([^\*]|\*(?!\/))*$/,action:{indentAction:d.IndentAction.None,appendText:" * "}},{beforeText:/^(\t|(\ \ ))*\ \*(\ ([^\*]|\*(?!\/))*)?$/,action:{indentAction:d.IndentAction.None,appendText:"* "}},{beforeText:/^(\t|(\ \ ))*\ \*\/\s*$/,action:{indentAction:d.IndentAction.None,removeText:1}}]}),d.languages.registerCompletionItemProvider(e,new E,"*","@")}),d.commands.registerTextEditorCommand("php-docblocker.trigger",e=>{e.selection=new d.Selection(e.selection.start,e.selection.start);let t=new d.Range(e.selection.start,e.selection.end),a=new A(t,e).autoDocument();e.insertSnippet(a)})}function J(){}0&&(module.exports={activate,deactivate});
